"0","mr <- c(""Don"", ""Major"", ""Capt"", ""Jonkheer"", ""Rev"", ""Col"", ""Sir"")"
"0","mrs <- c(""Countess"", ""Mme"", ""Lady"")"
"0","miss <- c(""Mlle"", ""Ms"")"
"0",""
"0","blueprint <- recipe(survived ~ ., data = training_data) %>%"
"0","  step_mutate("
"0","    pclass = as_factor(pclass),"
"0","    sex = as_factor(sex),"
"0","    title = str_extract(name, ""\\w+?(?=\\.)""),"
"0","    title = case_when("
"0","      title %in% mr ~ ""Mr"","
"0","      title %in% mrs ~ ""Mrs"","
"0","      title %in% miss ~ ""Miss"","
"0","      title == ""Dr"" & sex == ""male"" ~ ""Mr"","
"0","      title == ""Dr"" & sex == ""female"" ~ ""Mrs"","
"0","      TRUE ~ title),"
"0","    ) %>%"
"0","  # impute age using titles (groupwise imputation)"
"0","  step_bagimpute(age, impute_with = ""title"") %>%"
"0","  # drop columns"
"0","  step_rm(""passenger_id"", ""name"", ""sib_sp"", ""parch"", ""ticket"", ""cabin"","
"0","          ""embarked"", ""title"") %>%"
"0","  step_center(all_numeric(), -all_outcomes()) %>%"
"0","  step_scale(all_numeric(), -all_outcomes()) %>%"
"0","  step_dummy(all_nominal(), -all_outcomes(), one_hot = F) %>%"
"0","  step_nzv(all_predictors())"
"0",""
"0","# fit the recipe to the training data"
"0","prepped <- prep(blueprint, training = training_data, strings_as_factors = T)"
"0",""
"0","# transform the training data"
"0","juiced_train <- juice(prepped)"
"0","juiced_train"
