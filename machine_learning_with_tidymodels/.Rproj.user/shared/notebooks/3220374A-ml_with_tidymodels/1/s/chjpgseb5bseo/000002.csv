"0",""
"0","mr <- c(""Don"", ""Major"", ""Capt"", ""Jonkheer"", ""Rev"", ""Col"", ""Sir"")"
"0","mrs <- c(""Countess"", ""Mme"", ""Lady"")"
"0","miss <- c(""Mlle"", ""Ms"")"
"0",""
"0","mydf <- titanic %>%"
"0","  mutate(title = str_extract(name, ""\\w+?(?=\\.)""),"
"0","    title = as_factor(case_when("
"0","      title %in% mr ~ ""Mr"","
"0","      title %in% mrs ~ ""Mrs"","
"0","      title %in% miss ~ ""Miss"","
"0","      title == ""Dr"" & sex == ""male"" ~ ""Mr"","
"0","      title == ""Dr"" & sex == ""female"" ~ ""Mrs"","
"0","      TRUE ~ title)),"
"0","    cabin = substr(str_remove_all(cabin, ""[^a-zA-Z]""), 1, 1)"
"0","    )"
"0",""
"0","theme_set(theme_minimal())"
"0",""
"0","plot_histogram <- function(df, x, fill, subtitle) {"
"0","  df %>%"
"0","    ggplot(aes(x = {{ x }}, fill = {{ fill }})) +"
"0","    geom_histogram(position = ""identity"", alpha = .7) +"
"0","    theme(axis.title = element_blank()) +"
"0","    labs(subtitle = subtitle)"
"0","}"
"0",""
"0","plot_cdf <- function(df, x, colour, subtitle) {"
"0","  df %>%"
"0","    ggplot(aes(x = {{ x }}, col = {{ colour }})) +"
"0","    stat_ecdf(pad = F) +"
"0","    theme(axis.title = element_blank()) +"
"0","    labs(subtitle = subtitle)"
"0","}"
"0",""
"0","p1 <- mydf %>%"
"0","  count(survived) %>%"
"0","  ggplot(aes(x = reorder(survived, n), y = n, fill = survived)) +"
"0","  geom_col() +"
"0","  coord_flip() +"
"0","  theme(axis.title = element_blank(), legend.position = ""none"") +"
"0","  labs(subtitle = ""Balance of the outcome variable"")"
"0",""
"0","p2 <- mydf %>%"
"0","  count(pclass, survived) %>%"
"0","  ggplot(aes(x = pclass, y = n, fill = survived)) +"
"0","  geom_col(position = ""dodge"") +"
"0","  coord_flip() +"
"0","  theme(axis.title = element_blank(), legend.position = ""none"") +"
"0","  labs(subtitle = ""Survival rate across passenger classes"")"
"0",""
"0","p3 <- mydf %>%"
"0","  count(title, survived) %>%"
"0","  ggplot(aes(x = reorder(title, n), y = n, fill = survived)) +"
"0","  geom_col(position = ""dodge"") +"
"0","  coord_flip() +"
"0","  theme(axis.title = element_blank()) +"
"0","  labs(subtitle = ""Survival rate across titles"")"
"0",""
"0","p4 <- mydf %>%"
"0","  dplyr::filter(is.na(age)) %>%"
"0","  count(title) %>%"
"0","  ggplot(aes(x = reorder(title, n), y = n)) +"
"0","  geom_col() +"
"0","  coord_flip() +"
"0","  theme(axis.title = element_blank()) +"
"0","  labs(subtitle = ""# of missing age observations"")"
"0",""
"0","p5 <- mydf %>%"
"0","  dplyr::filter(!is.na(age)) %>%"
"0","  ggplot(aes(x = fct_reorder(title, age), y = age)) +"
"0","  geom_boxplot(outlier.alpha = .5) +"
"0","  coord_flip() +"
"0","  theme(axis.title = element_blank()) +"
"0","  labs(subtitle = ""Age distribution"")"
"0",""
"0","p6 <- plot_histogram(mydf, x = age, fill = survived, "
"0","                     subtitle = ""Age distribution"")"
"0","p7 <- plot_cdf(mydf, x = age, col = survived, "
"0","               subtitle = ""CDF of the age variable"")"
"0","p8 <- plot_histogram(mydf, x = fare, fill = survived, "
"0","                     subtitle = ""Fare distribution"")"
"0","p9 <- plot_cdf(mydf, x = fare, colour = survived, "
"0","               subtitle = ""CDF of the fare variable"")"
"0",""
"0","p1 / (p2 + p3) / (p4 + p5)"
